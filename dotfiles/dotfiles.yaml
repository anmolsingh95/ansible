- name: Ensure .config directory exists
  file:
    path: '~/.config'
    state: directory
    mode: '0755'

- name: Remove existing dotfiles or directories
  file:
    path: '{{ item.dest }}'
    state: absent
  with_items:
    - { dest: '~/.alacritty.toml' }
    - { dest: '~/.gitconfig' }
    - { dest: '~/.tmux.conf' }
    - { dest: '~/.zshrc' }
    - { dest: '~/.config/nvim' }
  become_user: "{{ ansible_user }}"

- name: Create symbolic links for dotfiles
  file:
    src: '{{ playbook_dir }}/dotfiles/{{ item.src }}'
    dest: '{{ item.dest }}'
    state: link
  with_items:
    - { src: '.alacritty.toml', dest: '~/.alacritty.toml' }
    - { src: '.gitconfig', dest: '~/.gitconfig' }
    - { src: '.tmux.conf', dest: '~/.tmux.conf' }
    - { src: '.zshrc', dest: '~/.zshrc' }
    - { src: 'nvim', dest: '~/.config/nvim' }
  become_user: "{{ ansible_user }}"
